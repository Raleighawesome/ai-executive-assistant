---
import BaseLayout from './BaseLayout.astro';

interface Props {
  title: string;
  description?: string;
}

const { title, description } = Astro.props;

const modules = [
  { href: '/docs', label: 'Overview', exact: true },
  { href: '/docs/foundation', label: 'Foundation' },
  { href: '/docs/meeting-processing', label: 'Meeting Processing' },
  { href: '/docs/rag-search', label: 'RAG Search' },
  { href: '/docs/calendar', label: 'Calendar Integration' },
  { href: '/docs/automation', label: 'Automation' },
];

const currentPath = Astro.url.pathname;
---

<BaseLayout title={title} description={description}>
  <div class="pt-24 pb-16">
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex flex-col lg:flex-row gap-8">
        <!-- Sidebar -->
        <aside class="lg:w-64 flex-shrink-0">
          <nav class="lg:sticky lg:top-24">
            <div class="text-xs font-semibold text-text-muted uppercase tracking-wider mb-4">
              Modules
            </div>
            <ul class="space-y-1">
              {modules.map((module) => {
                const isActive = module.exact
                  ? currentPath === module.href
                  : currentPath.startsWith(module.href) && module.href !== '/docs';
                return (
                  <li>
                    <a
                      href={module.href}
                      class={`block px-3 py-2 rounded-lg text-sm transition-colors ${
                        isActive
                          ? 'bg-accent/10 text-accent font-medium'
                          : 'text-text-secondary hover:text-text-primary hover:bg-surface-elevated'
                      }`}
                    >
                      {module.label}
                    </a>
                  </li>
                );
              })}
            </ul>

            <div class="mt-8 pt-8 border-t border-border">
              <a href="/setup" class="btn-primary w-full text-center text-sm">
                Setup Wizard
              </a>
            </div>
          </nav>
        </aside>

        <!-- Main content -->
        <main class="flex-1 min-w-0">
          <article class="prose prose-invert max-w-none">
            <slot />
          </article>
        </main>
      </div>
    </div>
  </div>
</BaseLayout>

<style is:global>
  .prose {
    --tw-prose-body: var(--color-text-secondary);
    --tw-prose-headings: var(--color-text-primary);
    --tw-prose-links: var(--color-accent);
    --tw-prose-code: var(--color-text-primary);
    --tw-prose-pre-bg: var(--color-surface);
  }

  .prose h1 {
    font-size: 1.875rem;
    font-weight: 700;
    margin-bottom: 1rem;
  }

  .prose h2 {
    font-size: 1.5rem;
    font-weight: 600;
    margin-top: 3rem;
    margin-bottom: 1rem;
  }

  .prose h3 {
    font-size: 1.25rem;
    font-weight: 600;
    margin-top: 2rem;
    margin-bottom: 0.75rem;
  }

  .prose p {
    margin-bottom: 1rem;
    line-height: 1.75;
  }

  .prose ul {
    margin-bottom: 1rem;
    margin-left: 1.5rem;
    list-style-type: disc;
  }

  .prose ol {
    margin-bottom: 1rem;
    margin-left: 1.5rem;
    list-style-type: decimal;
  }

  .prose li {
    margin-bottom: 0.5rem;
  }

  .prose a {
    color: var(--color-accent);
  }

  .prose a:hover {
    text-decoration: underline;
  }

  .prose code {
    background-color: var(--color-surface);
    padding: 0.125rem 0.375rem;
    border-radius: 0.25rem;
    font-size: 0.875rem;
    font-family: var(--font-family-mono);
  }

  .prose pre {
    background-color: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: 0.5rem;
    padding: 1rem;
    overflow-x: auto;
    margin-bottom: 1rem;
  }

  .prose pre code {
    background-color: transparent;
    padding: 0;
  }
</style>
